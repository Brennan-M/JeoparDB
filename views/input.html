<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <script src="/bower_components/jquery/dist/jquery.min.js"></script>
    <link href="/bower_components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href='https://fonts.googleapis.com/css?family=Fontdiner+Swanky' rel='stylesheet' type='text/css'>
    <script type="text/javascript">
      $(document).ready(function(){
        $("#submit").click(function() {
            $.post('/search', {"startDate": $("#startDateInput").val(),
                               "endDate": $("#endDateInput").val(),
                               "cluster": $("#clusterInput").val()},
                              function(data){
                console.log(data);
                document.getElementById('Question1').innerHTML = data[0]["Question"];
                document.getElementById('Category1').innerHTML = data[0]["Category"];
                document.getElementById('Cluster1').innerHTML = data[0]["Cluster"];

                document.getElementById('Status').innerHTML = ("");
                document.getElementById('real_answer').innerHTML = ("");
                $("#answerInput").val("")

                $("#confirmAnswer").click(function() {
                    var status;
                    if (isCorrect($("#answerInput").val(), data[0]["Answer"])) {
                      document.getElementById('Status').innerHTML = ("Correct!");
                      status = "correct";
                    } else {
                      status = "wrong";
                      document.getElementById('Status').innerHTML = ("Wrong!");
                    }

                    document.getElementById('real_answer').innerHTML = data[0]["Answer"];

                    $.post('/update', {"questionId": data[0]["QuestionId"], "status": status},
                    function(data) {
                        console.log(data);
                    });
                });
            });
                 
        });

      });

      function isSimilar(word1, word2) {
        word1 = word1.replace(/\\/, "");
        word1 = word1.replace(/"/, "");
        word1 = word1.replace(/'/, "");
        word2 = word2.replace(/\\/, "");
        word2 = word2.replace(/"/, "");
        word2 = word2.replace(/'/, "");
        console.log(word1);
        console.log(word2);
        //need to run lavenshteins algorithm
        return (word1 == word2);

      };

      // NEED TO REMOVE handle () as alternative and / for different pairs, handle first letter if it is 'a' allow and for &
      function isCorrect(response, answer) {
        var response = response.toLowerCase();
        var answer = answer.toLowerCase();

        var resArray = response.split(" ");
        var ansArray = answer.split(" ");

        if (ansArray.length != resArray.length) {
          return false;
        }

        for (var i = 0; i < ansArray.length; i++) {
          if (!isSimilar(resArray[i], ansArray[i])) {
            return false;
          }
        }

        return true;

        console.log(markCorrect);
        console.log(len);

      };

    </script>
    <title>JeoparDB</title>
  </head>
  <body>
    <br>
    <div class="input-group input-group-lg">
      <span class="input-group-addon" id="sizing-addon1">Start Date</span>
      <input type="text" id="startDateInput" class="form-control" placeholder="mm/dd/yyyy" aria-describedby="sizing-addon1">
    </div>
    <div class="input-group input-group-lg">
      <span class="input-group-addon" id="sizing-addon1">End Date</span>
      <input type="text" id="endDateInput" class="form-control" placeholder="mm/dd/yyyy" aria-describedby="sizing-addon1">
    </div>
    <div class="input-group input-group-lg">
      <span class="input-group-addon" id="sizing-addon1">Category</span>
      <input type="text" id="clusterInput" class="form-control" placeholder="cluster" aria-describedby="sizing-addon1">
    </div>
    <br>
    <button id="submit" type="button" class="btn btn-success btn-lg">Success</button>
    <h2>Cluster</h2>
    <p id="Cluster1"></p>
    <h2>Category</h2>
    <p id="Category1"></p>
    <h2>Question</h2>
    <p id="Question1"></p>
    
    <div class="input-group">
      <div class="input-group-btn">
          <button id="confirmAnswer" type="button" class="btn btn-primary">Submit</button>
      </div>
      <input type="text" id="answerInput" class="form-control" aria-label="...">
    </div>
    <h2 id="Status"></h2>
    <p id="real_answer"> </p>
  </body>
</html>
